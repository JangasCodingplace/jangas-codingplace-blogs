# Event Driven Programming mit Serverless Functions
Serverlose Datenverarbeitung ist ein moderne Art der Cloud, die es Entwicklerinnen und Entwicklern erlaubt sich auf die Programmierung zu konzentrieren, ohne dabei Infrastruktur oder Server zu managen - *so die Werbeversprechen*. Durch den serverlosen Ansatz wird das Management der Infrastruktur weg abstrahiert und komplett vom entsprechenden Cloud Anbieter gemaintained. Wir müssen also nur noch Code schreiben und ihn deployen.

## Ein paar Beispiele moderner Herausforderungen in Softwareprojekten
Es gibt eine Vielzahl an Herausforderungen und natürlichen können nicht alle von ihnen mit einem rein Serverlosen Ansatz gelöst werden. Allerdings muss man anerkennen, dass es durchaus Stellen gibt, an denen rein serverlose Funktionen für das Entwicklungsteam effizienzsteigernd sind. Diese werden gleich etwas näher beleuchtet.

Sobald Software Projekte wachsen, gewinnen sie leider an Komplexität. In der Praxis werden große Monolithische Strukturen dann gerne in viele kleinere Strukturen - sogenannte Microservices - aufgebrochen. Während eine einzige Softwarearchitektur in der Wahl der Tools und Sprachen oft beschränkt ist, kann man diese bei vielen kleinen Architekturen oft frei wählen und so den perfekten Ansatz für das entsprechende Problem finden - *so die Theorie*. Allerdings ist das managen dieser kleinen über die ganze Softwarelandschaft verteilten Anwendungen oft eine Herausforderung und endet gerne in einem operativen overhead. Die Wahl zwischen einem großen Monolithen oder kleinen Mircoservices ist ein ganz eigenes Thema und nicht so einfach, wie in der vielen Artikeln oft beschrieben.

Moderne Anwendungen haben dabei eine Vielzahl an *Events* auf die sie reagieren müssen. Das kann eine einfacher HTTP Request sein, bei dem ein Server in einer möglichst kurzen Zeit antworten muss, oder ein File Upload bei dem eine Anwendung auf einen SFTP Server reagieren muss, sobald eine File abgelegt wird. Es gibt auch Skripte die werden in bestimmten Zeitintervallen ausgeführt - z.B. Datenpipelines die einmal die Stunde ausgeführt werden. Diese verschiedenen Events bzw. Trigger eine Funktion auszuführen führen einer Anwendung nochmal zusätzlich Komplexität zu.

Durch Serverlose Funktionen können Unternehmen ihre Entwicklungsprozesse beschleunigen und den Wartungsaufwand reduzieren.

Durch die Nutzung der serverlosen Technologie können Unternehmen ihre Entwicklungsprozesse rationalisieren und den Wartungsaufwand reduzieren. Natürlich passt dieser Ansatz nicht zu jeder Challenge, aber gerade wenn Anwendungen auf eine Vielzahl an Events reagieren soll und gleichzeitig die Architektur und der Wartungsaufwand gering gehalten werden soll, macht es durchaus Sinn zu evaluieren, ob ein serverloser Ansatz nicht vielleicht zumindest partiell der richtige ist.


## Ich werde Skalierbarkeit nicht thematisieren!
Mir ist es wichtig anzumerken, dass Skalierbarkeit mehr ist als nur die Steigerung vom Datendurchsatz. Skalierung wird oft als reiner Begriff genutzt Manager für ein Produkt zu überzeugen. Heutzutage muss alles skalierbar und tolerant gegenüber allen Arten von Fehlern sein. Was das bedeutet, wissen die jenigen, die die Dienste bezahlen allerdings oft nicht. Für mich ist der Begriff "Skalierbarkeit", insbesondere im Kontext serverloser Architektur, erstmal nichts mehr als eine Werbebotschaft, die ich im Rahmen dieses Artikels nicht weiter beleuchten möchte.

## Einleitung in die Serverlose Architektur
Serverlose Anwendungen denken den Weg wie Anwendungen entwickelt und deployed werden neu. Ein Beispiel können File triggered functions sein. Also eine Aktion die dann ausgeführt werden soll, wenn eine File gespeichert, verändert oder gelöscht wird. In Verbindung mit einer Cloud wie AWS, Microsoft Azure oder GCP integrieren sich die Serverless Functions perfekt in das hauseigene Tooling wie S3, Azure Blob Storage oder analog der Google Cloud Storage und das ohne zusätzliche Strukturen, die es ermöglichen synchrone oder asynchrone Aktionen auf Grundlage eines bestimmten Events auszuführen. 

Event Driven Architekturen spielen allgemein eine unfassbar wichtige Rolle und fordern dabei oft Streaming Dienste oder Queues wie Azure Event Grid, Azure Service Bus, Apache Kafka oder RabbitMQ. Diese Tools erlauben eine asynchrone Kommunikation zwischen einzelnen Anwendungen und ermlgkichen damit die Entkopplung dieser Dienste. Serverlose Ansätze können von Haus aus wunderbar mit solchen Tools interagieren. Gerade wenn nicht sowas wie Kubernetes im Einsatz ist, oder nicht für alles eine eigene Node gebucht werden soll, ist der serverlose Ansatz eine Überlegung wert.

Natürlich gibt es auch die Möglichkeit periodisch- oder zeitgesteuerte Funktionen zu erstellen. Üblicherweise kann dies auch über Cronjobs - oder den verbotenen und doch oft genutzten `while True` Schleifen realisiert werden. Aber auch hier werden extra Nodes oder andere bestehende Infrastrukturen benötigt die oft in der Verantwortung anderer Teams liegen. Serverless kann nahezu immer im eigenen Team verwaltet werden.

An der Stelle ist es aber auch wichtig zu erwähnen, dass serverless nicht vergleichbar mit dem No-Code Hype ist. Auch wenn durch einen serverless Ansatz operative Aspekte weg abstrahiert werden, müssen Entwicklerinnen und Entwickler weiterhin Code schreiben um die Logik ihrer Anwendungen zu implementieren. Dabei unterstützt der serverlose Ansatz in Abhängigkeit der Plattform eine Vielzahl von Programmiersprachen wie Python, Java, JavaScript und viele mehr. Dies erlaubt Entwicklungsteams die für sie passende Sprachen und Bibliotheken für ihr Projekt zu verwenden.

## Unterschiede zwischen den großen Cloud Anbietern für serverlose Architekturen
Auch hier wird nicht im Detail drauf eingegangen. Zum einen ist das nicht Thema dieses Beitrags, zum anderen stark beeinflusst durch meine für einen guten Vergleich nicht gleichermaßen ausreichende Erfahrung. Aber eine Daumenregel kann ich mitgeben: *Wenn es um Umfang und Flexibilität geht, ist AWS gefühlt immer auf Platz 1, gefolgt von Microsoft Azure auf Platz 2 und GCP auf Platz 3*. Aber mit Umfang und Flexibilität verhält es sich wie mit der Skalierbarkeit: es ist gar nicht klar, was genau das eigentlich bedeutet! Also spielt dieser Umstand für viele Projekte und Unternehmen eine untergeordnete Rolle, da alle drei Anbieter extrem umfangreich sind und für jedes meiner eigenen Projekte in der Vergangenheit wäre jede dieser Anbieter austauschbar gewesen!

In der Regel verhält es sich ohnehin so, dass sich Unternehmen oder Teams bereits auf einen Cloud Anbieter verständigt haben und ein Vergleich in der Kategorie Serverlose Architektur für die wenigsten wirklich sinnvoll ist.

Stattdessen erstelle ich sobald wie möglich © für jeweils jeden der Cloud Anbieter ein komplettes serverloses Projekt und mache dieses zugänglich. Einen Vergleich stellt dies aber nicht da.

## Nachteile der serverlosen Architektur
Die **Preisgestaltung** kann echt unübersichtlich und intransparent wirken. Auch wenn *Pay-as-you-go* erstmal schön klingt und kosteneffizient zu sein scheint, da nur die Leistung bezahlt wird, die tatsächlich benötigt wird, kann es schwer sein vorauszuschauen ob der Ansatz wirklich günstiger ist oder mit temporären Peaks umzugehen. Der Preis entsteht übrigens oft aus der Dauer, die eine Serverlose Funktion benötigt um eine Aktion durchzuführen (*computation time*), dem Datentransfer  (*ingress/egress*) und natürlich den anderen Services die parallel in der Cloud laufen.

Allgemein ist das Konzept **Pay as you go** gegenüber eines fixen Preises diskutabel. In vielen Fällen möchte man zuverlässig wissen, was nächsten Monat, bzw. in den kommenden Monaten gezahlt werden muss. Um fair zu bleiben: Viele Cloud Anbieter bieten auch Enterprise Pläne an. Mit diesen wird die ganze Maschine gebucht, auf denen die serverlose Architektur läuft, der Cloud Anbieter übernimmt weiterhin die volle Verantwortung und gewährleistet einen dauerhaften Betrieb,  sodass es sich für das Entwicklungsteam nicht anders anfühlt. Allerdings gehen diese Pläne oft im mittleren bis oberen 3 stelligen Bereich los.

**Logging** ist in der Cloud auch immer ein treibender Kostenfaktor. Logs sind kleine Texteinheiten die für das Monitoring, dem finden von Fehlern oder zur Nachvollziehbarkeit eines Programms benötigt werden. Diese werden persistiert und indiziert. Das kostet Geld. Dabei habe ich bereits erlebt, dass Teams in der Cloud auf ein adäquates Logging verzichtet haben, weil das zu teuer wird. Insbesondere Funktionen die an einem Message Bus hängen sind extrem anfällig dafür in Dead Locks zu laufen und damit durch das Logging und die Computation Zeit Kosten zu verursachen.

Die **Flexibilität** ist im Vergleich zu anderen Lösungen auch recht eingeschränkt. Natürlich kann bei einem serverlosen Ansatz "einfach programmiert" werden. Allerdings kann durch Sprachlimitierungen oder der Architektur lange nicht jedes Framework oder jede Bibliothek verwendet werden.

## Persönliche Erfahrung
In der Vergangenheit habe ich serverlose Funktionen immer wieder verwendet und fand sie extrem nützlich. Einen Vorteil den ich immer wieder aufs neue Genieße, ist es kleine, lose Skripte ohne viel Infrastruktur zu deployen. Dabei habe ich diesen Ansatz in verschiedenen Firmen stets ergänzend zu anderen Architekturen gesehen. 

Entwicklerinnen und Entwickler finden das Konzept der serverlosen Architektur oft unintuitiv, ungewohnt und misstrauen diesem Ansatz. Sie wollen oft die absolute Kontrolle über ihre Architektur behalten und sehen den notwendigen operativen Aufwand als notwendiges Übel. Ausgehend meiner eigenen Erfahrung kann ich aber voller Überzeugung sagen, dass der serverlose Ansatz echt angenehm sein kann. Insbesondere wenn ohnehin schon verschiedene Cloud Dienste verwendet werden und sich dieser Ansatz perfekt in bestehende Lösungen eingliedert.

## Zusammenfassung
Die serverlose Architektur bietet einen mächtigen Ansatz Event getriebene Anwendungen - bzw. Anwendungen die auf verschiedene Trigger reagiert zu betreiben. Sie kann eine schnelle Entwicklung ohne zusätzlichen operativen Aufwand zu betreiben ermöglichen und kann dadurch für viele Projekte extrem attraktiv wirken. Natürlich gibt es in den Punkten der Preisgestaltung, Flexibilität und Logging auch massive Nachteile. Auf der anderen Seite können serverlose Architekturen gerade für kleinere Projekte oft günstiger als andere bekannte Lösungen wie das buchen einzelner Ubuntu Nodes sein.

Es ist in jedem Fall ratsam mal ein wenig mit diesem Ansatz zu experimentieren. Insbesondere für kleine Teams bedeuten full managed Services wie serverlose Funktionen oft eine echte Entlastung.
